{"version":3,"sources":["js/message.js"],"names":["createLi","item","li","document","createElement","img","Image","nickName","user","commentsText","append","className","classList","add","src","innerText","name","innerHTML","content","model","init","APP_ID","APP_KEY","AV","appId","appKey","fetch","query","Query","find","save","Message","Object","extend","message","view","querySelector","controller","messageList","form","loadMessages","bindEvents","then","array","map","attributes","i","addEventListener","e","preventDefault","saveMessage","bind","myForm","editor","txt","html","value","obj"],"mappings":"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","file":"message.baa57d69.map","sourceRoot":"..","sourcesContent":["(function () {\n    function createLi(item){\n        let li=document.createElement('li')\n        let img=new Image(38,38)\n        let nickName=document.createElement('span')\n        let user=document.createElement('div')\n        let commentsText=document.createElement('p')\n        user.append(img,nickName)\n        li.append(user,commentsText)\n\n        user.className='comments-user'\n        commentsText.className='comments-text'\n        li.classList.add('comments-li')\n\n        img.src='avatar.jpg'\n\n        nickName.innerText=item.name\n        commentsText.innerHTML=item.content\n\n        return li\n    }\n    let model = {\n        // 获取数据\n        init: function () {\n            var APP_ID = 't7gkIMdwW5vVGKrv6PHNXlvj-gzGzoHsz';\n            var APP_KEY = 'O1Y30UaAAS5RxJhOD5XWTq4B';\n            AV.init({\n                appId: APP_ID,\n                appKey: APP_KEY\n            });\n        },\n        fetch: function () {\n            let query=new AV.Query('Message')\n            return query.find() // Promise对象\n        },\n        save: function (name, content) {\n            // 声明类型\n            var Message = AV.Object.extend('Message');\n            // 新建对象\n            var message = new Message();\n            return message.save({ //Promise 对象\n                name:name,\n                content:content,\n            })\n        }\n\n    }\n    let view = document.querySelector('#comments')\n    let controller = {\n        view: null,\n        model: null,\n        messageList: null,\n        init: function (view, model) {\n            this.view=view\n            this.model=model\n\n            this.messageList=view.querySelector('#messageList')\n            this.form=view.querySelector('form')\n            this.model.init()\n            this.loadMessages()\n            this.bindEvents()\n        },\n        loadMessages: function () {\n            this.model.fetch().then(\n                (message)=>{\n                    let array=message.map((item)=>item.attributes)\n                    for(let i=0;i<10;i++){\n                            let li=createLi(array[i])\n                            this.messageList.append(li)\n                    }\n                }\n            )\n        },\n        bindEvents: function () {\n            this.form.addEventListener('submit',function(e){\n                e.preventDefault()\n                this.saveMessage()\n\n            }.bind(this))\n        },\n        saveMessage: function () {\n            let myForm=this.form\n            let content=editor.txt.html()\n            let name=myForm.querySelector('input[name=name]').value\n\n            this.model.save(name,content).then(function(obj){\n\n                let li=createLi(obj.attributes)\n                this.messageList.append(li)\n            })\n        }\n    }\n\n    controller.init(view, model)\n\n\n}())\n"]}